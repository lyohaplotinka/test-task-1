!function(e){var t={};function n(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);const s="http://localhost:3456";function a(e="GET",t,n={}){return new Promise((s,a)=>{const r=new XMLHttpRequest;r.open(e,t,!0),r.setRequestHeader("Content-Type","application/json"),r.send(n),r.onreadystatechange=function(){if(4===r.readyState)if(200!==r.status)a(r.statusText);else try{s(JSON.parse(r.responseText))}catch(e){s(r.responseText)}}})}async function r(e,t){return await a("GET",`${s}/search/${t}?search=${e}`)}class o{constructor(e,t){if(this.element=document.querySelector(e),this.autocomplete=document.querySelector(t),!this.element||!this.autocomplete)throw new Error("One of elements for SearchInputManipulator not found");this.requiredResults=Number("3"),this.setup()}setup(){this.servers=Array.from({length:Number("2")},(e,t)=>t),this.value="",this.searchTimeout=null,this.result=[],this.delegateSearchResultsEvent(),this.element.addEventListener("input",this.elementOnChange.bind(this)),this.element.addEventListener("focus",()=>{this.result.length&&(this.autocomplete.style.display="block")})}delegateSearchResultsEvent(){document.addEventListener("click",e=>{if(e.target.classList.contains("search-result")){const t=e.target.getAttribute("data-value");t&&(this.element.value=t.trim())}e.target.classList.contains("autocomplete-input")||(this.autocomplete.style.display="none")})}elementOnChange(e){const{value:t}=e.target;this.value=t,this.triggerSearchTimeout()}triggerSearchTimeout(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>this.doSearch(),500)}async doSearch(){if(this.result=[],!this.value)return this.clearAutocomplete(),void(this.autocomplete.style.display="none");for await(const e of this.servers){const t=await r(this.value,e);if(this.result=[...this.result,...t],this.result.length>=this.requiredResults)break}this.createAutocompleteElements()}clearAutocomplete(){for(;this.autocomplete.firstChild;)this.autocomplete.firstChild.remove()}createAutocompleteElements(){this.clearAutocomplete(),this.result.forEach(e=>{const t=document.createElement("div");t.classList.add("search-result"),t.innerText=e,t.setAttribute("data-value",e),this.autocomplete.appendChild(t)}),this.autocomplete.style.display="block"}}class i{constructor(e){if(this.element=document.querySelector(e),!this.element)throw new Error("Element for MaskedInput not found");this.value="",this.setup()}setup(){this.element.addEventListener("input",this.createMaskedOutput.bind(this))}cutMask(e){return e.replace(/\D/g,"")}createMask(e){return e.length>0&&e.length<2?("8"===e[0]&&(e="7"),"+"+e):e.length>=2&&e.length<5?e.replace(/(\d{1})(\d{1,3})/,"+$1 ($2"):e.length>=5&&e.length<8?e.replace(/(\d{1})(\d{3})(\d{1,3})/,"+$1 ($2) $3"):e.length>=8&&e.length<10?e.replace(/(\d{1})(\d{3})(\d{3})(\d{1,2})/,"+$1 ($2) $3-$4"):e.length>=10?e.replace(/(\d{1})(\d{3})(\d{3})(\d{2})(\d{1,2})/,"+$1 ($2) $3-$4-$5"):""}createMaskedOutput(e){const{value:t}=e.target,n=this.cutMask(t);let s=n.length<=11?n:this.value;this.element.value=this.createMask(s),this.element.setAttribute("data-number",s),this.value=s}setValue(e){this.value=e,this.element.value=this.createMask(e)}}class u{constructor(){const e=window.localStorage.getItem("testTaskFormData");this.formData={searchInput:"",phoneInput:""},e&&this.parseData(e)}parseData(e){try{const t=JSON.parse(e);this.formData={searchInput:t.searchInput||"",phoneInput:t.phoneInput||""},window.searchInput.element.value=this.formData.searchInput,window.maskedInput.setValue(this.formData.phoneInput)}catch(e){}}saveForm(){window.localStorage.setItem("testTaskFormData",JSON.stringify(this.formData))}clear(){this.formData={searchInput:"",phoneInput:""},this.saveForm()}set searchInput(e){this.formData.searchInput=e,this.saveForm()}set phoneInput(e){this.formData.phoneInput=e,this.saveForm()}}function l(){const e=document.getElementById("saveButton"),t=document.getElementById("clearButton");e.onclick=function(){window.storageService.searchInput=window.searchInput.element.value,window.storageService.phoneInput=window.maskedInput.value,async function(e){await a("POST",s+"/form/save",JSON.stringify(e))}(window.storageService.formData),alert("Сохранено!")},t.onclick=function(){window.storageService.clear(),window.searchInput.element.value="",window.maskedInput.value="",window.maskedInput.element.value=""}}n(0);document.addEventListener("DOMContentLoaded",()=>{window.searchInput=new o("#mainInput",".autocomplete-block"),window.maskedInput=new i("#maskedInput"),window.storageService=new u,l()})}]);